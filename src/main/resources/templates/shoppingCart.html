<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
  <link rel="stylesheet" th:href="@{/styles/style.css}">
</head>
<nav th:insert="~{components/navigation}"></nav>
<body>

<th:block th:if="${user != null}">
    <p th:text="'Hello, ' + ${user.username} + '! These items are in your Cart:'"></p>
</th:block>

<th:block th:if="${user == null}">
    <p th:text="'Hello! These items are in your Cart:'"></p>
</th:block>
<div class="alert alert-info" th:if="${outOfStockMessage}" th:utext="${outOfStockMessage}"></div>

<div th:if="${!products.entrySet().isEmpty()}">
    <div class="panel-default well" th:each="product: ${products.entrySet()}">
        <div class="panel-heading">
            <h1><a th:text="${product.getKey().productName}" th:href="@{'/products/' + ${product.getKey().productId}}">Title</a></h1>
        </div>
        <div class="row panel-body">
            <div th:inline="text" class="col-md-2">Price: [[${product.getKey().productPrice}]],- NOK</div>
            <div th:inline="text" class="col-md-9">Quantity: [[${product.getValue()}]]</div>
            <a th:href="@{'/shoppingCart/removeProduct/{id}'(id=${product.getKey().productId})}" class="col-md-1">
                <button type="button" class="btn btn-primary" th:text="'-'">Remove</button>
            </a>
            <a th:href="@{'/shoppingCart/addProduct/{id}'(id=${product.getKey().productId})}" class="col-md-1">
                <button type="button" class="btn btn-primary" th:text="'+'">Add</button>
            </a>
        </div>
    </div>

    <br>

    <div class="total">
        <h3 th:inline="text">Price of products: [[${total}]],-</h3>
    </div>

    <div class="shipping">
        <h3 th:inline="text">Price of shipping: [[${shipping}]],-</h3>
    </div>


    <div class="shipping">
        <h2 th:inline="text">TOTAL: [[${finalPrice}]],-</h2>
    </div>

    <br>

    <div class="container">
        <h1>Checkout</h1>
        <form action="/shoppingCart/checkout" method="POST">
            <div class="form-group">
                <label for="firstName">First Name:</label>
                <input type="text" class="form-control" id="firstName" name="firstName" placeholder="First Name" th:value="${#objects.nullSafe(user?.getAddress()?.firstName,'')}" required>
            </div>
            <div class="form-group">
                <label for="lastName">Last Name:</label>
                <input type="text" class="form-control" id="lastName"  name="lastName" placeholder="Last Name" th:value="${#objects.nullSafe(user?.getAddress()?.lastName,'')}" required>
            </div>
            <div class="form-group">
                <label for="phoneNumber">Phone Number:</label>
                <input type="text" class="form-control" id="phoneNumber" name="phoneNumber" placeholder="Phone Number" th:value="${#objects.nullSafe(user?.getAddress()?.phoneNumber,'')}" required>
            </div>
            <div class="form-group">
                <label for="username">Email:</label>
                <input type="email" class="form-control" id="username" name="username" placeholder="Email" th:value="${#objects.nullSafe(user?.username,'')}" required>
            </div>
            <div class="form-group">
                <label for="streetAddress">Street Address:</label>
                <input type="text" class="form-control" id="streetAddress" name="streetAddress" placeholder="Street Address"  th:value="${#objects.nullSafe(user?.getAddress()?.streetAddress,'')}" required>
            </div>
            <div class="form-group">
                <label for="postalCode">Postal Code:</label>
                <input type="text" class="form-control" id="postalCode" name="postalCode"placeholder="Postal Code" th:value="${#objects.nullSafe(user?.getAddress()?.postalCode,'')}" required>
            </div>
            <div class="form-group">
                <label for="city">City:</label>
                <input type="text" name="city" class="form-control" id="city" placeholder="City" th:value="${#objects.nullSafe(user?.getAddress()?.city,'')}" required>
            </div>
            <button type="submit" class="btn btn-primary">Checkout</button>
        </form>
    </div>
</div>



<div th:if="${products.entrySet().isEmpty()}">
    <p> Your cart seems to be empty. Go take a look at our <a th:href="@{'/products'}"> products</a>!</p>
</div>
<br>



</body>
<footer id="footer" th:insert="~{components/footer}"></footer>
</html>